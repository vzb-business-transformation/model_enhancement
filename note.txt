(streamlit) SRIWOPE@XHK9JJM27Y model_enhancement % python -m enhance_predict_sequence
run_sql took 56.12 seconds to run.

=== Starting Circuit Prediction Enhancement Pipeline ===


=== STEP 1: Loading existing base model ===

Data processor loaded from results/models/data_processor.joblib

Loading saved models...
Loaded model 'voting_ensemble' from results/models/voting_ensemble_model.joblib
Loaded model 'stacked_ensemble' from results/models/stacked_ensemble_model.joblib
Loaded model 'xgb' from results/models/xgb_model.joblib
Loaded model 'rf' from results/models/rf_model.joblib
Loaded model 'lgb' from results/models/lgb_model.joblib
Loaded model 'gb' from results/models/gb_model.joblib
Loaded model 'cat' from results/models/cat_model.joblib
Loaded feature importances from results/models/feature_importances.joblib
Loaded model parameters from results/models/model_params.joblib
Base models loaded successfully

=== STEP 2: Predicting January disconnect durations ===

Loading January data...
run_sql took 2.92 seconds to run.
January active circuits: 1 records
Starting data preprocessing...
WARNING: Target column 'DISCO_DURATION' not found in initial dataframe
After distribution - Target column has 1 non-NaN values out of 1 rows
Engineering features...
Feature engineering complete. New shape: (1, 85)
After feature engineering - Target column NaN count: 0
Traceback (most recent call last):
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/runpy.py", line 197, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/Users/SRIWOPE/PycharmProjects/model_enhancement/enhance_predict_sequence.py", line 333, in <module>
    main()
  File "/Users/SRIWOPE/PycharmProjects/model_enhancement/enhance_predict_sequence.py", line 142, in main
    jan_processed = data_processor.preprocess_data(jan_data, is_training=False, target_col='DISCO_DURATION')
  File "/Users/SRIWOPE/PycharmProjects/model_enhancement/data_processing.py", line 491, in preprocess_data
    df[col] = df[col].fillna(mode_value)
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/generic.py", line 7349, in fillna
    new_data = self._mgr.fillna(
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/internals/base.py", line 186, in fillna
    return self.apply_with_block(
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/internals/managers.py", line 363, in apply
    applied = getattr(b, f)(**kwargs)
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/internals/blocks.py", line 2334, in fillna
    new_values = self.values.fillna(value=value, method=None, limit=limit)
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/arrays/_mixins.py", line 372, in fillna
    new_values[mask] = value
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/arrays/_mixins.py", line 261, in __setitem__
    value = self._validate_setitem_value(value)
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/arrays/categorical.py", line 1589, in _validate_setitem_value
    return self._validate_scalar(value)
  File "/Users/SRIWOPE/miniforge3/envs/streamlit/lib/python3.9/site-packages/pandas/core/arrays/categorical.py", line 1614, in _validate_scalar
    raise TypeError(
TypeError: Cannot setitem on a Categorical with a new category (Unknown), set the categories first
(streamlit) SRIWOPE@XHK9JJM27Y model_enhancement %
